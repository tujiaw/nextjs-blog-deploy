---
title: 'centos rpm使用方法'
date: '2019-10-08'
tags: ['Linux']
draft: false
summary: CentOS RPM 用于 Linux 软件管理，有五种操作模式。可通过多种命令进行安装（如 rpm -i）、查询（如 rpm -q）、卸载（如 rpm -e）、升级（如 rpm -U）和验证（如 rpm -V）。默认安装路径及其他命令也有介绍。 
---

在 Linux 操作系统下，几乎所有的软件均通过RPM 进行安装、卸载及管理等操作。RPM 的全称为Redhat Package Manager ，是由Redhat 公司提出的，用于管理Linux 下软件包的软件。Linux 安装时，除了几个核心模块以外，其余几乎所有的模块均通过RPM 完成安装。RPM 有五种操作模式，分别为：安装、卸载、升级、查询和验证。

谨慎使用
```
rpm -ivh --nodeps --force 包 # 强制安装
rpm -e --nodeps --noscripts 包 # 强制卸载
```

# RPM 安装操作
命令：rpm -i 需要安装的包文件名  
举例如下：
```
rpm -i example.rpm 安装 example.rpm 包；

rpm -iv example.rpm 安装 example.rpm 包并在安装过程中显示正在安装的文件信息；

rpm -ivh example.rpm 安装 example.rpm 包并在安装过程中显示正在安装的文件信息及安装进度；
```

# RPM 查询操作
命令：rpm -q …  
附加查询命令：
```
a 查询所有已经安装的包以下两个附加命令用于查询安装包的信息；

i 显示安装包的信息；

l 显示安装包中的所有文件被安装到哪些目录下；

s 显示安装版中的所有文件状态及被安装到哪些目录下；以下两个附加命令用于指定需要查询的是安装包还是已安装后的文件；

p 查询的是安装包的信息；

f 查询的是已安装的某文件信息；
```
举例如下：  
```
rpm -qa | grep tomcat4 查看 tomcat4 是否被安装；

rpm -qip example.rpm 查看 example.rpm 安装包的信息；

rpm -qif /bin/df 查看/bin/df 文件所在安装包的信息；

rpm -qlf /bin/df 查看/bin/df 文件所在安装包中的各个文件分别被安装到哪个目录下；
```
# RPM 卸载操作
命令：rpm -e 需要卸载的安装包  
在卸载之前，通常需要使用rpm -q …命令查出需要卸载的安装包名称。  
举例如下：
```
rpm -e tomcat4 卸载 tomcat4 软件包
```
RPM 软件包的卸载要考虑包之间的依赖性。例如，我们先安装的 httpd 软件包，后安装 httpd 的功能模块 mod_ssl 包，那么在卸载时，就必须先卸载 mod_ssl，然后卸载 httpd，否则会报错。  
软件包卸载和拆除大楼是一样的，本来先盖的 2 楼，后盖的 3 楼，那么拆楼时一定要先拆除 3 楼。  
> RPM 软件包的卸载命令支持使用“-nodeps”选项，即可以不检测依赖性直接卸载，但此方式不推荐大家使用，因为此操作很可能导致其他软件也无法正常使用。

# RPM 升级操作
命令：rpm -U 需要升级的包  
举例如下：  
```
rpm -Uvh example.rpm 升级 example.rpm 软件包
```

# RPM 验证操作
命令：rpm -V 需要验证的包  
举例如下：  
```
rpm -Vf /etc/tomcat4/tomcat4.conf
```
输出信息类似如下：  
```
S.5....T c /etc/tomcat4/tomcat4.conf
```
> 其中，S 表示文件大小修改过，T 表示文件日期修改过。限于篇幅，更多的验证信息请您参考rpm 帮助文件：man rpm

# RPM 的其他附加命令
```
--force 强制操作 如强制安装删除等；

--requires 显示该包的依赖关系；

--nodeps 忽略依赖关系并继续操作；
```

# RPM包默认安装路径
通常情况下，RPM 包采用系统默认的安装路径，所有安装文件会按照类别分散安装到表 1 所示的目录中。
```
/etc/	配置文件安装目录
/usr/bin/	可执行的命令安装目录
/usr/lib/	程序所使用的函数库保存位置
/usr/share/doc/	基本的软件使用手册保存位置
/usr/share/man/	帮助文件保存位置
```

RPM 包的默认安装路径是可以通过命令查询的。  

除此之外，RPM 包也支持手动指定安装路径，但此方式并不推荐。因为一旦手动指定安装路径，所有的安装文件会集中安装到指定位置，且系统中用来查询安装路径的命令也无法使用（需要进行手工配置才能被系统识别），得不偿失。  

与 RPM 包不同，源码包的安装通常采用手动指定安装路径（习惯安装到 /usr/local/ 中）的方式。既然安装路径不同，同一 apache 程序的源码包和 RPM 包就可以安装到一台 Linux 服务器上（但同一时间只能开启一个，因为它们需要占用同一个 80 端口）。  

实际情况中，一台服务器几乎不会同时包含两个 apache 程序，管理员不好管理，还会占用过多的服务器磁盘空间。  

# RPM 包的安装
安装 RPM 的命令格式为：[root@localhost ~]# rpm -ivh 包全名  
注意一定是包全名。涉及到包全名的命令，一定要注意路径，可能软件包在光盘中，因此需提前做好设备的挂载工作。  
此命令中各选项参数的含义为：
```
-i：安装（install）;
-v：显示更详细的信息（verbose）;
-h：打印 #，显示安装进度（hash）;
```

此命令还可以一次性安装多个软件包，仅需将包全名用空格分开即可，如下所示：
```
[root@localhost ~]# rpm -ivh a.rpm b.rpm c.rpm
```

如果还有其他安装要求（比如强制安装某软件而不管它是否有依赖性），可以通过以下选项进行调整：  
```
-nodeps：不检测依赖性安装。软件安装时会检测依赖性，确定所需的底层软件是否安装，如果没有安装则会报错。如果不管依赖性，想强制安装，则可以使用这个选项。注意，这样不检测依赖性安装的软件基本上是不能使用的，所以不建议这样做。
-replacefiles：替换文件安装。如果要安装软件包，但是包中的部分文件已经存在，那么在正常安装时会报"某个文件已经存在"的错误，从而导致软件无法安装。使用这个选项可以忽略这个报错而覆盖安装。
-replacepkgs：替换软件包安装。如果软件包已经安装，那么此选项可以把软件包重复安装一遍。
-force：强制安装。不管是否已经安装，都重新安装。也就是 -replacefiles 和 -replacepkgs 的综合。
-test：测试安装。不会实际安装，只是检测一下依赖性。
-prefix：指定安装路径。为安装软件指定安装路径，而不使用默认安装路径。
```